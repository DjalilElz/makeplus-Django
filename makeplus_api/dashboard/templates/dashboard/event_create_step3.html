{% extends 'dashboard/base.html' %}

{% block page_title %}Create Event - Step 3: Sessions{% endblock %}

{% block content %}
<div class="container">
    <!-- Progress Steps -->
    <div class="progress-steps">
        <div class="progress-step completed">
            <div class="progress-step-circle"><i class="bi bi-check"></i></div>
            <div>Event Details</div>
        </div>
        <div class="progress-step completed">
            <div class="progress-step-circle"><i class="bi bi-check"></i></div>
            <div>Rooms</div>
        </div>
        <div class="progress-step active">
            <div class="progress-step-circle">3</div>
            <div>Sessions</div>
        </div>
        <div class="progress-step">
            <div class="progress-step-circle">4</div>
            <div>Users</div>
        </div>
    </div>
    
    <!-- Event & Room Info -->
    <div class="alert alert-info mb-4">
        <div class="row">
            <div class="col-md-6">
                <strong><i class="bi bi-calendar-event"></i> Event:</strong> {{ event.name }}
            </div>
            <div class="col-md-6 text-end">
                <strong><i class="bi bi-door-open"></i> Room:</strong> {{ current_room.name }} ({{ room_number }}/{{ total_rooms }})
            </div>
        </div>
    </div>
    
    <!-- Progress Bar -->
    <div class="progress mb-4" style="height: 30px;">
        <div class="progress-bar progress-bar-striped" role="progressbar" 
             style="width: {{ progress }}%">
            Room {{ room_number }} of {{ total_rooms }}
        </div>
    </div>
    
    <div class="row">
        <!-- Existing Sessions -->
        <div class="col-md-4 mb-4">
            <div class="stat-card">
                <h5 class="mb-3"><i class="bi bi-list-ul"></i> Sessions in {{ current_room.name }}</h5>
                
                {% if existing_sessions %}
                    <div class="list-group">
                        {% for session in existing_sessions %}
                        <div class="list-group-item">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <strong>{{ session.title }}</strong>
                                    <br>
                                    <small class="text-muted">
                                        {% if session.session_type == 'conference' %}
                                            <span class="badge bg-primary">Conference</span>
                                        {% elif session.session_type == 'atelier' %}
                                            <span class="badge bg-warning text-dark">Atelier</span>
                                        {% else %}
                                            <span class="badge bg-info">Workshop</span>
                                        {% endif %}
                                    </small>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="mt-3">
                        <p class="text-muted mb-0"><small>{{ existing_sessions.count }} session(s) added</small></p>
                    </div>
                {% else %}
                    <div class="text-center py-4">
                        <i class="bi bi-inbox" style="font-size: 2rem; color: #ccc;"></i>
                        <p class="text-muted small mt-2">No sessions yet</p>
                    </div>
                {% endif %}
                
                <div class="d-grid gap-2 mt-3">
                    <form method="post">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="next_room">
                        <button type="submit" class="btn btn-success btn-sm w-100">
                            <i class="bi bi-check-circle"></i> Done with this room
                        </button>
                    </form>
                    <form method="post">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="skip_room">
                        <button type="submit" class="btn btn-outline-secondary btn-sm w-100">
                            <i class="bi bi-skip-forward"></i> Skip this room
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Add Session Form -->
        <div class="col-md-8 mb-4">
            <div class="stat-card">
                <h5 class="mb-4">
                    <i class="bi bi-plus-circle"></i> Add Session/Conference/Atelier
                </h5>
                
                <form method="post">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="add_session">
                    
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.title.id_for_label }}" class="form-label">Session Title *</label>
                            {{ form.title }}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.session_type.id_for_label }}" class="form-label">Type *</label>
                            {{ form.session_type }}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.theme.id_for_label }}" class="form-label">Theme</label>
                            {{ form.theme }}
                        </div>
                        
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
                            {{ form.description }}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.start_time.id_for_label }}" class="form-label">Start Time *</label>
                            {{ form.start_time }}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.end_time.id_for_label }}" class="form-label">End Time *</label>
                            {{ form.end_time }}
                        </div>
                        
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.speaker_name.id_for_label }}" class="form-label">Speaker Name</label>
                            {{ form.speaker_name }}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.speaker_title.id_for_label }}" class="form-label">Speaker Title</label>
                            {{ form.speaker_title }}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.max_participants.id_for_label }}" class="form-label">Max Participants</label>
                            {{ form.max_participants }}
                        </div>
                        
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.youtube_live_url.id_for_label }}" class="form-label">
                                <i class="bi bi-youtube"></i> YouTube Live URL
                            </label>
                            {{ form.youtube_live_url }}
                            <div class="form-text">Optional: Add YouTube live stream for hybrid events</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <div class="form-check">
                                {{ form.is_paid }}
                                <label class="form-check-label" for="{{ form.is_paid.id_for_label }}">
                                    Paid Session/Atelier
                                </label>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.price.id_for_label }}" class="form-label">Price (DZD)</label>
                            {{ form.price }}
                        </div>
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-plus-circle"></i> Add Session
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
